<div class="setting">
  <div class="setting-label">
    <label>{{i18n "admin.wizard.type"}}</label>
  </div>
  
  <div class="setting-value">
    {{combo-box
      value=action.type
      content=types
      onChange=(action (mut action.type))
      options=(hash
        none="admin.wizard.field.type"
      )}}
  </div>
</div>

{{#if basicTopicFields}}
  <div class="setting full field-mapper-setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.title"}}</label>
    </div>
    
    <div class="setting-value">
      {{wizard-field-mapper
        inputs=action.title
        wizardFields=wizardFields
        options=(hash
          hasOutput=true
          wizardFieldSelection=true
          userFieldSelection='key,value'
        )}}
    </div>
  </div>

  <div class="setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.post"}}</label>
    </div>
    
    <div class="setting-value">
      {{combo-box
        value=action.post
        content=wizardFields
        nameProperty='label'
        onChange=(action (mut action.post))
        options=(hash
          none='admin.wizard.select_field'
          isDisabled=action.post_builder
        )}}
      
      <div class="setting-gutter">
        {{input type='checkbox' checked=action.post_builder}}
        <span>{{i18n 'admin.wizard.action.post_builder.checkbox'}}</span>
      </div>
    </div>
  </div>

  {{#if action.post_builder}}
    <div class="setting full">
      <div class="setting-label">
        <label>{{i18n 'admin.wizard.action.post_builder.label'}}</label>
      </div>
      
      <div class="setting-value editor">
        {{wizard-text-editor
          value=action.post_template
          wizardFields=wizardFields}}
      </div>
    </div>
  {{/if}}
{{/if}}

{{#if publicTopicFields}}
  <div class="setting full field-mapper-setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.create_topic.category"}}</label>
    </div>
    
    <div class="setting-value">
      {{wizard-field-mapper
        inputs=action.category
        wizardFields=wizardFields
        options=(hash
          hasOutput=true
          categorySelection='output'
          wizardFieldSelection=true
          userFieldSelection='key,value'
        )}}
    </div>
  </div>
  
  <div class="setting full field-mapper-setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.create_topic.tags"}}</label>
    </div>
    
    <div class="setting-value">
      {{wizard-field-mapper
        inputs=action.tags
        wizardFields=wizardFields
        options=(hash
          hasOutput=true
          tagSelection='output'
          wizardFieldSelection=true
          userFieldSelection='key,value'
        )}}
    </div>
  </div>
{{/if}}

{{#if newTopicFields}}
  <div class="setting full">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.skip_redirect.label"}}</label>
    </div>
    
    <div class="setting-value">
      {{input type='checkbox' checked=action.skip_redirect}}
      
      <span>
        {{i18n 'admin.wizard.action.skip_redirect.description' type='topic'}}
      </span>
    </div>
  </div>
{{/if}}

{{#if basicTopicFields}}
  <div class="setting full field-mapper-setting">
    <div class="setting-label">
      <label>{{i18n 'admin.wizard.action.add_fields.label'}}</label>
    </div>
    
    {{wizard-field-mapper
      inputs=action.add_fields
      wizardFields=wizardFields
      connectorKey='admin.wizard.action.add_fields.connector'
      options=(hash
        wizardFieldSelection=true
      )}}
  </div>
{{/if}}

{{#if sendMessage}}
  <div class="setting full field-mapper-setting">
    <div class="setting-label">
      <label>{{i18n 'admin.wizard.required'}}</label>
    </div>
    
    <div class="setting-value">
      {{wizard-field-mapper
        inputs=action.required
        wizardFields=wizardFields
        options=(hash
          enableConnectors=true
          wizardFieldSelection=true
          userFieldSelection=true
          groupSelection=true
        )}}
    </div>
  </div>
  
  <div class="setting full field-mapper-setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.send_message.recipient"}}</label>
    </div>
    
    <div class="setting-value">
      {{wizard-field-mapper
        inputs=action.recipient
        wizardFields=wizardFields
        options=(hash
          hasOutput=true
          wizardFieldSelection=true
          userFieldSelection=true
          groupSelection='key,value'
        )}}
    </div>
  </div>
{{/if}}

{{#if updateProfile}}
  <div class="setting full field-mapper-setting">
    <div class="setting-label">
      <label>{{i18n 'admin.wizard.action.add_fields.label'}}</label>
    </div>
    
    {{wizard-field-mapper 
      inputs=action.profile_updates
      wizardFields=wizardFields
      connectorKey='admin.wizard.action.add_fields.connector'
      options=(hash
        wizardFieldSelection=true
        userFieldSelection=true
      )}}
  </div>
{{/if}}

{{#if sendToApi}}
  <div class="setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.send_to_api.api"}}</label>
    </div>
    
    <div class="setting-value">
      {{combo-box
        value=action.api
        content=availableApis
        onChange=(action (mut action.api))
        options=(hash
          isDisabled=action.custom_title_enabled
          none='admin.wizard.action.send_to_api.select_an_api'
        )}}
    </div>
  </div>

  <div class="setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.send_to_api.endpoint"}}</label>
    </div>
    
    <div class="setting-value">
      {{combo-box
        value=action.api_endpoint
        content=availableEndpoints
        onChange=(action (mut action.api_endpoint))
        options=(hash
          isDisabled=apiEmpty
          none='admin.wizard.action.send_to_api.select_an_endpoint'
        )}}
    </div>
  </div>

  <div class="setting full">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.send_to_api.body"}}</label>
    </div>
    
    <div class="setting-value">
      {{wizard-text-editor
        value=action.api_body
        previewEnabled=false
        barEnabled=false
        wizardFields=wizardFields
        placeholder='admin.wizard.action.send_to_api.body_placeholder'}}
    </div>
  </div>
{{/if}}

{{#if addToGroup}}
  <div class="setting full field-mapper-setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.group"}}</label>
    </div>
    
    <div class="setting-value">
      {{wizard-field-mapper
        inputs=action.inputs
        wizardFields=wizardFields
        outputConnectorKey='admin.wizard.action.add_to_group.output_connector'
        options=(hash
          hasOutput=true
          enableConnectors=true
          wizardFieldSelection='key,value,assignment'
          userFieldSelection='key,value,assignment'
          groupSelection='value,output'
        )}}
    </div>
  </div>
{{/if}}

{{#if routeTo}}
  <div class="setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.route_to.url"}}</label>
    </div>
    
    <div class="setting-value">
      {{input value=action.url}}
    </div>
  </div>
  
  <div class="setting">
    <div class="setting-label">
      <label>{{i18n "admin.wizard.action.route_to.code"}}</label>
    </div>
    
    <div class="setting-value">
      {{input value=action.code}}
    </div>
  </div>
{{/if}}
